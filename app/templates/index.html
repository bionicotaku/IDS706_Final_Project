<!DOCTYPE html>
<html lang="en">

<head>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Welcome to AI Chat</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      height: 100vh;
      margin: 0;
      background-color: #f5f5f5;
      overflow-y: auto;
    }

      h1 {
        color: #333;
        margin-bottom: 30px;
      }

      .start-button {
        padding: 15px 30px;
        font-size: 18px;
        background-color: #2196f3;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        transition: background-color 0.3s;
      }

    .start-button:hover {
      background-color: #1976d2;
    }
    .form-style {
  display: flex;
  flex-direction: column;
  align-items: center;
  margin-top: 20px;
  padding: 20px;
  border: 1px solid #ccc;
  border-radius: 8px;
  background-color: #fff;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  }

  .form-style label {
    margin: 10px 0 5px;
    font-weight: bold;
    color: #333;
  }

  .form-style input {
    padding: 8px;
    width: 200px;
    border: 1px solid #ccc;
    border-radius: 4px;
    margin-bottom: 15px;
  }

  .form-style button {
    padding: 10px 20px;
    font-size: 16px;
    background-color: #2196f3;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    transition: background-color 0.3s;
  }

  .form-style button:hover {
    background-color: #1976d2;
  }



  </style>
</head>

<body>

  <!-- Explore Movie Genres Over Time -->
  <!-- form for inputting start and end year -->
  <h1 style="color: #2c3e50; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;">Explore Movie Genres Over Time</h1>
  <h3 style="color: #2c3238; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; text-align: center; max-width: 600px;">
    This service allows users to analyze the popularity of different movie genres over a specified time range.
  </h3>
  <h3 style="color: #34495e; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; text-align: center; max-width: 600px;">
    Please enter a start year and end year to analyze the movie genres over time.
  </h3>
  <form id="yearForm" class="form-style">
    <label for="startYear">Start Year:</label>
    <input type="number" id="startYear" name="startYear" required>
    <label for="endYear">End Year:</label>
    <input type="number" id="endYear" name="endYear" required>
    <button type="submit">Analyze</button>
  </form>

  <!-- Canvas for the genre chart -->
  <div style="width: 600px; height: 400px;">
  <canvas id="genreChart" width="600" height="400"></canvas>
  </div>
  <div id="error-message" style="color: red; margin-top: 10px;"></div>
  <script>
    let genreChart; 
    document.getElementById('yearForm').addEventListener('submit', function(event) {
      event.preventDefault();
      const startYear = document.getElementById('startYear').value;
      const endYear = document.getElementById('endYear').value;
      // Fetch data and update chart
      fetch('/analysis/analyze', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ startYear, endYear })
        })
        .then(response => response.json())
        .then(data => {
          if (data.error) {
          document.getElementById('error-message').textContent = 'Error: ' + data.error;
          return;
        }

        document.getElementById('error-message').textContent = '';

          const ctx = document.getElementById('genreChart').getContext('2d');
          const colors = [
            'rgba(255, 99, 132, 0.2)',
            'rgba(54, 162, 235, 0.2)',
            'rgba(255, 206, 86, 0.2)',
            'rgba(75, 192, 192, 0.2)',
            'rgba(153, 102, 255, 0.2)',
            'rgba(255, 159, 64, 0.2)',
            'rgba(255, 99, 71, 0.2)',
            'rgba(60, 179, 113, 0.2)',
            'rgba(123, 104, 238, 0.2)',
            'rgba(255, 215, 0, 0.2)',
            'rgba(0, 191, 255, 0.2)',
            'rgba(255, 69, 0, 0.2)',
            'rgba(50, 205, 50, 0.2)',
            'rgba(138, 43, 226, 0.2)',
            'rgba(255, 20, 147, 0.2)',
            'rgba(0, 255, 255, 0.2)',
            'rgba(255, 140, 0, 0.2)',
            'rgba(34, 139, 34, 0.2)',
            'rgba(75, 0, 130, 0.2)'
          ];
          const borderColors = [
            'rgba(255, 99, 132, 1)',
            'rgba(54, 162, 235, 1)',
            'rgba(255, 206, 86, 1)',
            'rgba(75, 192, 192, 1)',
            'rgba(153, 102, 255, 1)',
            'rgba(255, 159, 64, 1)',
            'rgba(255, 99, 71, 1)',
            'rgba(60, 179, 113, 1)',
            'rgba(123, 104, 238, 1)',
            'rgba(255, 215, 0, 1)',
            'rgba(0, 191, 255, 1)',
            'rgba(255, 69, 0, 1)',
            'rgba(50, 205, 50, 1)',
            'rgba(138, 43, 226, 1)',
            'rgba(255, 20, 147, 1)',
            'rgba(0, 255, 255, 1)',
            'rgba(255, 140, 0, 1)',
            'rgba(34, 139, 34, 1)',
            'rgba(75, 0, 130, 1)'
          ];
          data.genres.sort((a, b) => {
            const totalA = a.counts.reduce((sum, count) => sum + count, 0);
            const totalB = b.counts.reduce((sum, count) => sum + count, 0);
            return totalB - totalA;
          });
          if (genreChart) {
          genreChart.destroy();
        }
        genreChart = new Chart(ctx, {
            type: 'bar',
            data: {
              labels: data.years,
              datasets: data.genres.map((genre, index) => ({
                label: genre.name,
                data: genre.counts,
                backgroundColor: colors[index % colors.length],
                borderColor: borderColors[index % borderColors.length],
                borderWidth: 1
              }))
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              scales: {
                x: { stacked: true, grid: { display: false } },
                y: { stacked: true, grid: { display: false } }
              }
            }
          });
        })
        .catch(error => console.error('Error fetching data:', error));
    });
  </script>


<!-- Explore Movie Popularity -->
 <!-- form for inputting year -->
<h1 style="color: #2c3e50; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;">Explore Movie Popularity</h1>
<h3 style="color: #34495e; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; text-align: center; max-width: 600px;">
  This service displays the most and least popular movies based on TMDB's popularity scores.
</h3>
<h3 style="color: #34495e; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; text-align: center; max-width: 600px;">
  Please enter a specific year to get the most and least popular movies.
</h3>
<form id="popularityForm" class="form-style">
  <label for="popularityYear">Year:</label>
  <input type="number" id="popularityYear" name="year" required>
  <button type="submit">Get Popularity</button>
</form>

<!-- Canvas for the popularity chart -->
<div style="width: 600px; height: 400px;">
  <canvas id="popularityChart" width="600" height="400"></canvas>
  </div>

  <script>
    let popularityChart; 

    document.getElementById('popularityForm').addEventListener('submit', function(event) {
      event.preventDefault();
      const year = document.getElementById('popularityYear').value;

      fetch('/analysis/popularity', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({ year })
      })
      .then(response => response.json())
      .then(data => {
        if (data.error) {
          document.getElementById('error-message').textContent = 'Error: ' + data.error;
          return;
        }

        document.getElementById('error-message').textContent = '';
        const topMovies = data.top_movies;
        const bottomMovies = data.bottom_movies;

        const labels = [...topMovies.map(movie => movie.title), ...bottomMovies.map(movie => movie.title)];
        const popularityScores = [...topMovies.map(movie => movie.popularity), ...bottomMovies.map(movie => movie.popularity)];
        const backgroundColors = [
          ...Array(topMovies.length).fill('rgba(75, 192, 192, 0.2)'), // Green for top movies
          ...Array(bottomMovies.length).fill('rgba(255, 99, 132, 0.2)') // Red for bottom movies
        ];
        const borderColors = [
          ...Array(topMovies.length).fill('rgba(75, 192, 192, 1)'),
          ...Array(bottomMovies.length).fill('rgba(255, 99, 132, 1)')
        ];
        const ctx = document.getElementById('popularityChart').getContext('2d');
        if (popularityChart) {
          popularityChart.destroy();
        }
        popularityChart = new Chart(ctx, {
          type: 'bar',
          data: {
            labels: labels,
            datasets: [{
              label: 'Popularity Score',
              data: popularityScores,
              backgroundColor: backgroundColors,
              borderColor: borderColors,
              borderWidth: 1
            }]
          },
          options: {
            scales: {
              x: { grid: { display: false } },
              y: { beginAtZero: true }
            }
          }
        });
      })
      .catch(error => console.error('Error fetching popularity data:', error));
    });

  </script>


  <h1>Welcome to AI Chat Assistant</h1>
  <button class="start-button" onclick="window.location.href='/chat/chat-interface'">
    Start Chat
  </button>
</body>

</html>

